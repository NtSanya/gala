# 0x8400d7bc

## Invalid
r0 = 0x84016fc9
r1 = ?
r2 = 0x4d656d7a
r3 = 0x696d6733
r4 = 0x84006195
r5 = 0x84016fc9
r6 = 0x84000128

## Valid
r0 = 0x84016fc9
r1 = ?
r2 = 0x4d656d7a
r3 = 0x696d6733
r4 = 0x84006195
r5 = 0x84016fc9
r6 = 0x84000128


# 0x8400d7bc

## Invalid
0x4600f0c0  # Different!
0x00000000
0x4d656d7a  # Memz
0x696d6733  # img3
0x4600a1c0  # Different!
0x46008eb8  # Same
0x000060b8  # Different!
0x46008e78  # Same
0x5f958000  # Same

## Valid
0x4600f300  # Different!
0x00000000
0x4d656d7a  # Memz
0x696d6733  # img3
0x4600f280  # Different!
0x46008eb8  # Same
0x000060c4  # Different!
0x46008e78  # Same
0x5f958000  # Same

## Another valid
0x4600f640  # Increments, looks like a heap address?
0x00000000
0x4d656d7a  # Memz
0x696d6733  # img3
0x4600f5c0  # Different, memory address?
0x46008eb8  # Same
0x00011244  # Different, looks significant? Looks like a length field
0x46008e78  # Same
0x5f958000  # Same

# 0x8400d9c4

## Invalid
0x00000016
0x00000000
0x00000000
0x00000001
0x5f95d880
0x00000001
0x5f958000
0x46008dd0
0x4600f0c0

## Valid
Register dump
0x00000000
0x5f969124
0x40000000
0x00040001
0x5f968a0c
0x00000000
0x5f958000
0x46008dd0
0x4600f280

# 0x8400d800

## Invalid
0x4600f0c0
0x8401d7a8
0x00000000
0x00020003
0x4600a1c0
0x46008eb8
0x000060b8
0x46008dd0
0x4600f0c0

## Valid
0x4600f280
0x8401d7a8
0x00000000
0x00020003
0x4600f200
0x46008eb8
0x00011244
0x46008dd0
0x4600f280

# 0x8400dade

## Invalid
0xffffffff
0x46008d31
0x47415244
0x47415244
0x5f95d880
0x5f95d90c
0x5f958000
0x46008d78
0x4600f0c0

## Valid
0x00000000
0x46008aa4
0x47415244
0x47415244
0x5f968a0c
0x5f968a98
0x5f958000
0x46008d78
0x4600f280

# 0x84015e08

## Invalid
Register dump
0x00000000
0x000003f8
0x00000002
0x00000790
0x46008c4c
0x00000000
0x5f958000
0x46008d60
0x4600f0c0

Register dump
0x00000000
0x00000394
0x00000002
0x00000394
0x46008c54
0x00000001
0x5f958000
0x46008d60
0x4600f0c0

## Valid
Register dump
0x00000000
0x000003f8
0x00000002
0x00000790
0x46008c4c
0x00000000
0x5f958000
0x46008d60
0x4600f0c0

Register dump
0x00000000
0x00000394
0x00000002
0x00000394
0x46008c54
0x00000001
0x5f958000
0x46008d60
0x4600f0c0

Everything is the same for valid & invalid images

# 0x840161f8 (looks like a -1 return path?)
0xffffffff
0x46008d31
0x47415244
0x47415244
0x00000080
0x46008c48
0x00000010
0x46008d60
0x46008ad4

(Not called for valid image)

# 0x84015e2a

## Invalid
Register dump
0x00000000
0x5f95d918
0x000003fc
0x00000794
0x46008c4c
0x00000000
0x5f958000
0x46008d60
0x4600f0c0

Register dump
0x00000000
0x5f95dd14
0x00000398
0x00000398
0x46008c54
0x00000001
0x5f958000
0x46008d60
0x4600f0c0

## Valid
Register dump
0x00000000
0x5f95d924
0x000003fc
0x00000794
0x46008c4c
0x00000000
0x5f958000
0x46008d60
0x4600f280

Register dump
0x00000000
0x5f95dd20
0x00000398
0x00000398
0x46008c54
0x00000001
0x5f958000
0x46008d60
0x4600f280

# 0x84015e54

Register dump
0x00000000
0x00000000
0x00000398
0x5f95e0ac
0x46008c5c
0x00000002
0x5f958000
0x46008d60
0x4600f0c0

Register dump
0x00000000
0x00000000
0x00000398
0x5f95e0b8
0x46008c5c
0x00000002
0x5f958000
0x46008d60
0x4600f280

Registers look the same

# 0x84015ef8

## Invalid

Register dump
0x00000000
0x00000002
0x00000000
0x00000003
0x46008c00
0x00000018
0x5f958000
0x46008d60
0x46008aa4

Register dump
0x00000000
0x00000002
0x00000000
0x00000003
0x46008c18
0x00000018
0x00000018
0x46008d60
0x46008abc

Register dump
0x00000000
0x00000002
0x00000000
0x00000003
0x46008c30
0x00000018
0x00000018
0x46008d60
0x46008ad4

## Valid

Register dump
0x00000000
0x00000002
0x00000000
0x00000003
0x46008c00
0x00000018
0x5f958000
0x46008d60
0x46008aa4

Register dump
0x00000000
0x00000002
0x00000000
0x00000003
0x46008c18
0x00000018
0x00000018
0x46008d60
0x46008abc

Register dump
0x00000000
0x00000002
0x00000000
0x00000003
0x46008c30
0x00000018
0x00000018
0x46008d60
0x46008ad4

Registers look the same for valid & invalid images

# 0x84015f10

## Invalid

Register dump
0x00000000
0x00000009
0x00000001
0x0000000a
0x46008c00
0x00000018
0x5f958000
0x46008d60
0x46008aa4

Register dump
0x00000000
0x00000009
0x00000001
0x0000000a
0x46008c18
0x00000018
0x00000018
0x46008d60
0x46008abc

Register dump
0x00000000
0x00000009
0x00000001
0x0000000a
0x46008c30
0x00000018
0x00000018
0x46008d60
0x46008ad4

## Valid

Register dump
0x00000000
0x00000009
0x00000001
0x0000000a
0x46008c00
0x00000018
0x5f958000
0x46008d60
0x46008aa4

Register dump
0x00000000
0x00000009
0x00000001
0x0000000a
0x46008c18
0x00000018
0x00000018
0x46008d60
0x46008abc

Register dump
0x00000000
0x00000009
0x00000001
0x0000000a
0x46008c30
0x00000018
0x00000018
0x46008d60
0x46008ad4

# 0x84015f8a

## Invalid

Register dump
0x46008aa4
0x00000000
0x00000000
0x0000017a
0x00000000
0x00000018
0x5f958000
0x46008d60
0x46008aa4

## Valid

Register dump
0x46008aa4
0x00000000
0x00000000
0x0000017a
0x00000000
0x00000018
0x5f958000
0x46008d60
0x46008aa4

Registers look the same

# 0x84015fae

## Invalid image

Register dump
0x00000000
0x8401cb01
0x0000000e
0x00000030
0x00000000
0x00000018
0x5f958000
0x46008d60
0x46008aa4

Register dump
0x00000000
0x8401cb12
0x0000000f
0x00000030
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008aa4

Register dump
0x00000000
0x8401cb31
0x0000001d
0x00000030
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008aa4

Register dump
0x00000000
0x8401cb52
0x0000001f
0x00000030
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008aa4

Register dump
0x00000000
0x8401cc67
0x00000002
0x00000030
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008aa4

Register dump
0x00000000
0x5f95db77
0x0000000e
0x00000030
0x00000008
0x00000018
0x00000018
0x46008d60
0x46008abc

Register dump
0x00000000
0x5f95db88
0x0000000f
0x00000030
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008abc

Register dump
0x00000000
0x5f95dba7
0x0000001d
0x00000030
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008abc

Register dump
0x00000000
0x5f95dbc8
0x0000001f
0x00000030
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008abc

Register dump
0x00000000
0x5f95dc00
0x00000036
0x00000030
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008abc

Register dump
0x00000000
0x5f95deff
0x0000000b
0x00000030
0x00000010
0x00000018
0x00000018
0x46008d60
0x46008ad4

Register dump
0x00000000
0x5f95df1e
0x0000001d
0x00000030
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008ad4

Register dump
0x00000000
0x5f95df3f
0x0000001f
0x00000030
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008ad4

Register dump
0x00000000
0x5f95df98
0x00000057
0x00000030
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008ad4

## Valid image

Register dump
0x00000000
0x8401cb01
0x0000000e
0x00000030
0x00000000
0x00000018
0x5f958000
0x46008d60
0x46008aa4

Register dump
0x00000000
0x8401cb12
0x0000000f
0x00000030
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008aa4

Register dump
0x00000000
0x8401cb31
0x0000001d
0x00000030
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008aa4

Register dump
0x00000000
0x8401cb52
0x0000001f
0x00000030
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008aa4

Register dump
0x00000000
0x8401cc67
0x00000002
0x00000030
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008aa4

Register dump
0x00000000
0x5f95db83
0x0000000e
0x00000030
0x00000008
0x00000018
0x00000018
0x46008d60
0x46008abc

Register dump
0x00000000
0x5f95db94
0x0000000f
0x00000030
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008abc

Register dump
0x00000000
0x5f95dbb3
0x0000001d
0x00000030
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008abc

Register dump
0x00000000
0x5f95dbd4
0x0000001f
0x00000030
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008abc

Register dump
0x00000000
0x5f95dc0c
0x00000036
0x00000030
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008abc

Register dump
0x00000000
0x5f95df0b
0x0000000b
0x00000030
0x00000010
0x00000018
0x00000018
0x46008d60
0x46008ad4

Register dump
0x00000000
0x5f95df2a
0x0000001d
0x00000030
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008ad4

Register dump
0x00000000
0x5f95df4b
0x0000001f
0x00000030
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008ad4

Register dump
0x00000000
0x5f95dfa4
0x00000057
0x00000030
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008ad4

Registers look the same for the last iteration

# 0x8401602a

## Invalid

Register dump
0x00000000
0x00000003
0x8401cb52
0x00000003
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008aa4

Register dump
0x00000000
0x00000003
0x5f95dbc8
0x00000003
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008abc

Register dump
0x00000000
0x00000003
0x5f95df3f
0x00000003
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008ad4

## Valid

Register dump
0x00000000
0x00000003
0x8401cb52
0x00000003
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008aa4

Register dump
0x00000000
0x00000003
0x5f95dbd4
0x00000003
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008abc

Register dump
0x00000000
0x00000003
0x5f95df4b
0x00000003
0x00000000
0x00000000
0x00000018
0x46008d60
0x46008ad4

Registers look roughly the same on first and last iterations

# 0x84016148

## Invalid

0x00000000
0x00000014
0x00000000
0x5f95d88c
0x00000080
0x46008c48
0x00000010
0x46008d60
0x46008ad4
panic: __stack_chk_fail: stack corrupted
LLB found invalid memory signature, Rebooting

## Valid

0x00000000
0x00000014
0x00000000
0x5f95d898
0x00000080
0x46008c48
0x00000010
0x46008d60
0x46008ad4
panic: __stack_chk_fail: stack corrupted

Registers look roughly the same

# 0x84016170

## Invalid

0x00000000
0x46008db4
0x40000000
0x00000023
0x00000080
0x46008c48
0x00000010
0x46008d60
0x46008ad4

## Valid

0x00000000
0x46008db4
0x40000000
0x00000023
0x00000080
0x46008c48
0x00000010
0x46008d60
0x46008ad4

# 0x84016184

## Invalid
0xffffffff
0x46008d31
0x47415244
0x47415244
0x00000080
0x46008c48
0x00000010
0x46008d60
0x46008ad4

## Valid
0x00000000
0x46008d31
0x47415244
0x47415244
0x00000080
0x46008c48
0x00000010
0x46008d60
0x46008ad4

# 0x84015bb0

## Invalid

Register dump
0x00000000
0x00000001
0x00000100
0x00000002
0x46008b0c
0x4600864c
0x00000000
0x46008a94
0x46008cf0

Register dump
0x00000000
0x00000001
0x00000100
0x00000002
0x46008b5c
0x4600864c
0x00000008
0x46008a94
0x46008cf0

Register dump
0x00000000
0x00000001
0x00000100
0x00000002
0x00000080
0x4600864c
0x00000010
0x46008a94
0x46008cf0

## Valid

Register dump
0x00000000
0x00000001
0x00000100
0x00000002
0x46008b0c
0x4600864c
0x00000000
0x46008a94
0x46008cf0

Register dump
0x00000000
0x00000001
0x00000100
0x00000002
0x46008b5c
0x4600864c
0x00000008
0x46008a94
0x46008cf0

Register dump
0x00000000
0x00000001
0x00000100
0x00000002
0x00000080
0x4600864c
0x00000010
0x46008a94
0x46008cf0

Called for valid and invalid, last iteration looks exactly the same

# 0x84015c6e

## Invalid

Register dump
0x00000001
0x00000023
0x46008763
0x46008761
0x46008664
0x4600864c
0x00000001
0x46008a94
0x46008cf0

## Valid

Register dump
0x00000001
0x00000023
0x46008763
0x46008761
0x46008664
0x4600864c
0x00000001
0x46008a94
0x46008cf0

Registers look exactly the same

# 0x84015cba

## Invalid

0x00000000
0x46008d31
0x00000000
0x46008663
0x46008664
0x4600864c
0x00000001
0x46008a94
0x46008cf0

## Valid

0x00000000
0x46008d31
0x00000000
0x46008663
0x46008664
0x4600864c
0x00000001
0x46008a94
0x46008cf0

Registers look exactly the same for valid and invalid images

# 0x84015cd8

# Invalid

Register dump
0x00000000
0x46008d31
0x47415244
0x47415244
0x46008664
0x4600864c
0x00000001
0x46008a94
0x46008aa4
panic: __stack_chk_fail: stack corrupted

# Valid

0x00000000
0x46008d31
0x47415244
0x47415244
0x46008664
0x4600864c
0x00000001
0x46008a94
0x46008aa4
panic: __stack_chk_fail: stack corrupted

Registers are the same

New hypothesis: func@0x84015b74 succeeds the first 2 times 
it's called, but on call #3 it fails for invalid images!
Might be tough to debug...

# 0x840160f4

## Invalid

Register dump
0x00000000
0x46008d31
0x47415244
0x47415244
0x46008b0c
0x46008c18
0x00000000
0x46008d60
0x46008aa4

Register dump
0x00000000
0x46008d31
0x47415244
0x47415244
0x46008b5c
0x46008c30
0x00000008
0x46008d60
0x46008abc

## Valid

Register dump
0x00000000
0x46008d31
0x47415244
0x47415244
0x46008b0c
0x46008c18
0x00000000
0x46008d60
0x46008aa4

Register dump
0x00000000
0x46008d31
0x47415244
0x47415244
0x46008b5c
0x46008c30
0x00000008
0x46008d60
0x46008abc

# 0x84016184

PatchRegion.quick(0x84015bb0, Instr.thumb("cmp r0, r0")),
PatchRegion.quick(0x84015cba, Instr.thumb("b #0x84015cc0")),
PatchRegion.quick(0x84015be8, Instr.thumb("cmp r0, r0")),
PatchRegion.quick(0x84015bfe, Instr.thumb("cmp r0, r0")),

## Invalid

Register dump
0x000000ff
0x46008d31
0x47415244
0x47415244
0x00000080
0x46008c48
0x00000010
0x46008d60
0x46008ad4

## Valid

Register dump
0x00000000
0x46008d31
0x47415244
0x47415244
0x00000080
0x46008c48
0x00000010
0x46008d60
0x46008ad4

Next patch..

PatchRegion.quick(0x84015bb0, Instr.thumb("cmp r0, r0")),
PatchRegion.quick(0x84015cba, Instr.thumb("b #0x84015cc0")),
PatchRegion.quick(0x84015be8, Instr.thumb("cmp r0, r0")),
PatchRegion.quick(0x84015bfe, Instr.thumb("cmp r0, r0")),


--- 

# 0x8400de90 (image3_load_validate_constraints entry)

## Invalid
0x4600f0c0
0x00000000
0x4d656d7a
0x696d6733
0x4600a1c0
0x46008eb8
0x000060b8
0x46008e78
0x5f958000

## Valid
0x4600f280
0x00000000
0x4d656d7a
0x696d6733
0x4600f200
0x46008eb8
0x000060c4
0x46008e78
0x5f958000

# 0x8400de98

## Invalid
Register dump
0x00000001
0x8401d7a8
0x47415244
0x47415244
0x4600a1c0
0x00000001
0x000060b8
0x46008e78
0x5f958000

## Valid
Register dump
0x00000000
0x8401d7a8
0x47415244
0x47415244
0x4600f200
0x00000000
0x000060c4
0x46008e78
0x5f958000

# 0x8400def2

## Invalid
0x00000001
0x53444f4d
0x00000001
0x00000001
0x00000001
0x4600f0c0
0x000060b8
0x46008e78
0x5f958000

## Valid

0x00000000
0x00000001
0x00000001
0x00000000
0x00000000
0x4600f0c0
0x000060c4
0x46008e78
0x5f958000

# Valid

Register dump
0x00000000
0x00008930
0x00000001
0x00000000
0x00000000
0x4600f0c0
0x000060c4
0x46008e78
0x5f958000

# Invalid

Register dump
0x00000001
0x43484950
0x00000001
0x00000001
0x00000001
0x4600f3c0
0x000060d4
0x46008e78
0x5f958000

# Valid
Register dump
0x4600f0c0
0x43484950
0x00008930
0x00000000
0x4600f0c0
0x4600f0c0
0x000060c4
0x46008e78
0x5f958000

# Invalid
Register dump
0x4600f3c0
0x43484950
0x00008930
0x00000000
0x4600f3c0
0x4600f3c0
0x000060d4
0x46008e78
0x5f958000

Register dump
0x00000000
0x43484950
0x00008930
0x00000000
0x00000000
0x4600f280
0x000060d4
0x46008e78
0x5f958000

# 0x8400e052

## Valid

0x5f958040
0x00000000
0x00000000
0x4600f0c0
0x00000000
0x00005747
0x000060c4
0x46008e78
0x5f958000
"panic: image3_load_decrypt_payload: ASSERT FAILED at (lib/image/image3/image3_wrapper.c:image3_load_decrypt_payload:1174466782): NULL != payloadBuffer"

## Invalid

0x5f958040
0x00000000
0x00000000
0x4600f0c0
0x00000000
0x00005747
0x000060d4
0x46008e78
0x5f958000
panic: image3_load_decrypt_payload: ASSERT FAILED at (lib/image/image3/image3_wrapper.c:image3_load_decrypt_payload:1174466782): NULL != payloadBuffer
